{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>;.

    @template local_questionconverter/main
    @description Converter home page

    Example context (json):
    { 
        "link_return": "http://example.com/course", 
        "name-return": "Back", 
        "message": "Convert your PDF into questions ready to import", 
        "form_action": "http://example.com/local/questionconverter/index.php", 
        "sesskey": "abc123", 
        "courseid": 2, 
        "text-indicators": "Separate by indicators", 
        "text-selectcategory": "Select or drag your PDF file", 
        "text-selectcategory-help": "PDF files only", 
        "text-uploadpdf": "Selected file", 
        "text-change-file": "Change file", 
        "text-convert-and-import": "Convert and import", 
        "text-clear": "Clear", 
        "text-grid-success": "Quick conversion", 
        "text-grid-success-help": "Convert PDF documents into ready-to-use questions.", 
        "text-grid-info": "Smart import", 
        "text-grid-info-help": "Automatically create categories based on your settings.", 
        "text-loading": "Processing...", 
        "text-loading-help": "We are extracting the questions from the PDF.", 
        "footer": "Question Converter", 
        "year": "2026" 
    }
}}

<div class="flex gap-3 max-w-sm mb-4 float-right">
   <a class="py-2.5 px-3 rounded-lg text-sm font-medium text-white bg-blue-600 link-clean hover:bg-blue-800 transition duration-300" href="{{link_return}}">{{#str}}name-return, local_questionconverter{{/str}}</a>
</div>
<div class="bg-white">    

    <div class="max-w-4xl mx-auto px-2 py-8">
        <div class="">
            <p class="text-gray-600 mt-2 text-base">{{#str}}message, local_questionconverter{{/str}}</p>
        </div>
    </div>
    <div class="max-w-4xl mx-auto">
        <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
            <div class="p-8">
                    <form action="{{form_action}}" method="post" enctype="multipart/form-data" id="formulario" {{^form_action}}action="."{{/form_action}}>
                    
                    <input type="hidden" name="sesskey" value="{{sesskey}}">
                    <input type="hidden" name="courseid" value="{{courseid}}">

                    <label class="relative inline-flex items-center cursor-pointer">
                    <input type="checkbox" value="1" class="sr-only peer" name="with_indicators">
                    <span class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-100  rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></span>
                    <span class="ms-3 text-md font-medium text-gray-700">{{#str}}text-indicators, local_questionconverter{{/str}}</span>
                    </label>
                    
                    <div id="qc-drop-zone" class="relative border-2 border-dashed border-gray-300 rounded-xl transition-all duration-200 p-8 md:p-12 text-center cursor-pointer hover:border-primary hover:bg-blue-50">
                    <div id="qc-upload-content" class="flex flex-col items-center justify-center gap-2 pointer-events-none">
                        <div class="relative">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-12 h-12 font-bold text-blue-600">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5" />
                            </svg>
                        </div>
                        <p class="text-xl font-semibold text-gray-900">
                           {{#str}}text-selectcategory, local_questionconverter{{/str}}<br> 
                            <span class="text-gray-600 font-normal">{{#str}}text-selectcategory-help, local_questionconverter{{/str}}</span>
                        </p>
                    </div>

                    <div id="qc-file-selected-content" class="hidden flex-col items-center justify-center gap-2 pointer-events-none">
                        <div class="bg-white p-4 rounded-full shadow-md">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-12 h-12 text-blue-600">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                            </svg>

                        </div>
                        <div class="text-center">
                            <p class="text-sm text-gray-600 mb-1">{{#str}}text-uploadpdf, local_questionconverter{{/str}}</p>
                            <p id="file-name" class="text-lg font-semibold text-gray-900"></p>
                            <p id="file-size" class="text-sm text-gray-500 mt-1"></p>
                        </div>
                        <button type="button" id="qc-btn-change" class="mt-2 text-primary hover:text-blue-700 font-medium text-sm pointer-events-auto">
                           {{#str}}text-change-file, local_questionconverter{{/str}}
                        </button>
                    </div>
                    
                    <input type="file" name="pdffile" id="qc-document-file" accept=".pdf" required 
                           class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
                </div>
                
                    <div class="mt-6 flex gap-4 justify-center flex-wrap">
                        <button type="submit" id="qc-btn-convert" class="hidden inline-flex items-center gap-2 bg-primary text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-600 hover:shadow-lg">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M4 3C4.55228 3 5 3.44772 5 4V6.34298C6.64938 4.30446 9.17168 3 12 3C16.5903 3 20.3767 6.43564 20.9304 10.8763C20.9988 11.4243 20.6099 11.924 20.0618 11.9923C19.5138 12.0607 19.0141 11.6718 18.9458 11.1237C18.5153 7.67174 15.5689 5 12 5C9.62231 5 7.51998 6.18566 6.25442 8H9C9.55228 8 10 8.44772 10 9C10 9.55228 9.55228 10 9 10H4C3.44772 10 3 9.55228 3 9V4C3 3.44772 3.44772 3 4 3ZM3.93815 12.0077C4.48619 11.9393 4.98587 12.3282 5.05421 12.8763C5.48467 16.3283 8.43109 19 12 19C14.3777 19 16.48 17.8143 17.7456 16H15C14.4477 16 14 15.5523 14 15C14 14.4477 14.4477 14 15 14H20C20.5523 14 21 14.4477 21 15V20C21 20.5523 20.5523 21 20 21C19.4477 21 19 20.5523 19 20V17.657C17.3506 19.6955 14.8283 21 12 21C7.40967 21 3.62332 17.5644 3.06958 13.1237C3.00124 12.5757 3.39011 12.076 3.93815 12.0077Z" fill="white"/>
                        </svg>
                            {{#str}}text-convert-and-import, local_questionconverter{{/str}}
                        </button>
            
                        <button type="button" id="qc-btn-reset" class="hidden inline-flex items-center gap-2 bg-white text-red-600 px-8 py-3 rounded-lg font-semibold border-2 border-red-600 transition-all duration-200 hover:bg-red-600 hover:text-red-400">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                             {{#str}}text-clear, local_questionconverter{{/str}}
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="mt-12 grid md:grid-cols-2 gap-2">
          <div class="text-center">
            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-4">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-blue-600">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5" />
            </svg>
            </div>
            <h3 class="font-semibold text-gray-900">{{#str}}text-grid-success, local_questionconverter{{/str}}</h3>
            <p class="text-gray-600 text-sm mt-2">
              {{#str}}text-grid-success-help, local_questionconverter{{/str}}
            </p>
          </div>
          <div class="text-center">
            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-4">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-blue-600">
                <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99" />
                </svg>
            </div>
            <h3 class="font-semibold text-gray-900">{{#str}}text-grid-info, local_questionconverter{{/str}}</h3>
            <p class="text-gray-600 text-sm mt-2">
             {{#str}}text-grid-info-help, local_questionconverter{{/str}}
            </p>
          </div>
    </div>

        <!-- Loader -->
        <div id="qc-loader" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 z-50 flex items-center justify-center backdrop-blur-sm">
            <div class="bg-white rounded-2xl p-8 shadow-2xl flex flex-col items-center gap-6 max-w-sm mx-4">
                <!-- Spinner-->
                <div class="relative">
                    <div class="animate-spin rounded-full h-20 w-20 border-4 border-gray-200 border-t-blue-700"></div>
                    <div class="absolute inset-0 flex items-center justify-center">
                        <svg class="w-10 h-10 text-blue-700" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z"/>
                        </svg>
                    </div>
                </div>
                
                <div class="text-center">
                    <p class="text-gray-900 font-bold text-lg mb-2">{{#str}}text-loading, local_questionconverter{{/str}}</p>
                    <p class="text-gray-600 text-sm">{{#str}}text-loading-help, local_questionconverter{{/str}}{{}}</p>
                </div>
                
                <div class="w-full bg-gray-200 rounded-full h-2 overflow-hidden">
                    <div class="bg-blue-700 h-full rounded-full animate-pulse" style="width: 70%;"></div>
                </div>
                
            </div>
        </div>

    <div class="max-w-4xl mx-auto mt-12 h-16 text-center">
        <p class="text-sm text-gray-700 font-semibold">{{#str}}stringfooter, local_questionconverter{{/str}} - {{year}}</p>
    </div>
</div>